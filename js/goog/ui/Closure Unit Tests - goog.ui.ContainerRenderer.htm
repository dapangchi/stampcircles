<!DOCTYPE html>
<!-- saved from url=(0091)http://closure-library.googlecode.com/svn/trunk/closure/goog/ui/containerrenderer_test.html -->
<HTML><!--
Copyright 2008 Google Inc. All Rights Reserved.

--><HEAD><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <TITLE>Closure Unit Tests - goog.ui.ContainerRenderer</TITLE>
  <SCRIPT src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/base.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/deps.js"></SCRIPT>
  <SCRIPT>
    goog.require('goog.dom');
    goog.require('goog.testing.ExpectedFailures');
    goog.require('goog.testing.jsunit');
    goog.require('goog.testing.ui.rendererasserts');
    goog.require('goog.ui.Container');
    goog.require('goog.ui.ContainerRenderer');
    goog.require('goog.ui.Control');
    goog.require('goog.ui.ControlRenderer');
  </SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/array.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/tagname.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/classes.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/coordinate.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/size.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/object.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/string.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/useragent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/dom.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/relativetimeprovider.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/formatter.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/structs.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/iter.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/map.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/set.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/debug.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/logrecord.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/logger.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/box.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/rect.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/product.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/style.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/divconsole.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/errorhandlerweakdep.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/disposable.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/event.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/browserevent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/eventwrapper.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/listener.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/simplepool.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/jscript.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/pools.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/events.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/stacktrace.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/asserts.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/testcase.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/expectedfailures.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/testrunner.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/jsunit.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/rendererasserts.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/a11y.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/keycodes.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/eventtarget.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/keyhandler.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/eventhandler.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/idgenerator.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/component.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/controlcontent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/controlrenderer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/registry.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/decorate.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/control.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/menuseparatorrenderer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/separator.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/containerrenderer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.ContainerRenderer_files/container.js"></SCRIPT>
<STYLE>.dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}</STYLE></HEAD><BODY>
  <DIV id="sandbox"></DIV>

  <SCRIPT>
    var renderer;
    var expectedFailures = new goog.testing.ExpectedFailures();

    function setUp() {
      var sandbox = goog.dom.$('sandbox');

      sandbox.appendChild(goog.dom.createDom('span', {
        id: 'noTabIndex'
      }, 'Test'));
      sandbox.appendChild(goog.dom.createDom('span', {
        id: 'tabIndexNegative2',
        tabIndex: -2
      }, 'Test'));
      sandbox.appendChild(goog.dom.createDom('span', {
        id: 'tabIndexNegative1',
        tabIndex: -1
      }, 'Test'));
      sandbox.appendChild(goog.dom.createDom('span', {
        id: 'tabIndex0',
        tabIndex: 0
      }, 'Test'));
      sandbox.appendChild(goog.dom.createDom('span', {
        id: 'tabIndex1',
        tabIndex: 1
      }, 'Test'));
      sandbox.appendChild(goog.dom.createDom('span', {
        id: 'tabIndex2',
        tabIndex: 2
      }, 'Test'));
      sandbox.appendChild(goog.dom.createDom('div', {
        id: 'container',
        'class': 'goog-container-horizontal'
      }, goog.dom.createDom('div', {
        id: 'control',
        'class': 'goog-control'
      }, 'Hello, world!')));

      renderer = goog.ui.ContainerRenderer.getInstance();
    }

    function tearDown() {
      goog.dom.$('sandbox').innerHTML = '';
      expectedFailures.handleTearDown();
    }

    function testGetInstance() {
      assertTrue('getInstance() must return a ContainerRenderer',
          renderer instanceof goog.ui.ContainerRenderer);
      assertEquals('getInstance() must return the same object each time',
          renderer, goog.ui.ContainerRenderer.getInstance());
    }

    function testGetCustomRenderer() {
      var cssClass = 'special-css-class';
      var containerRenderer = goog.ui.ContainerRenderer.getCustomRenderer(
          goog.ui.ContainerRenderer, cssClass);
      assertEquals(
          'Renderer should have returned the custom CSS class.',
          cssClass,
          containerRenderer.getCssClass());
    }

    function testGetAriaRole() {
      assertUndefined('ARIA role must be undefined', renderer.getAriaRole());
    }

    function testHasTabIndex() {
      assertFalse('hasTabIndex() must return false for null argument',
          renderer.hasTabIndex(null));
      assertFalse('hasTabIndex() must return false for no tab index',
          renderer.hasTabIndex(goog.dom.$('noTabIndex')));
      assertFalse('hasTabIndex() must return false for tab index -2',
          renderer.hasTabIndex(goog.dom.$('tabIndexNegative2')));
      assertFalse('hasTabIndex() must return false for tab index -1',
          renderer.hasTabIndex(goog.dom.$('tabIndexNegative1')));

      // WebKit on Mac doesn't support tabIndex for arbitrary DOM elements
      // until version 527 or later.
      expectedFailures.expectFailureFor(goog.userAgent.WEBKIT &&
          goog.userAgent.MAC && !goog.userAgent.isVersion('527'));
      try {
        assertTrue('hasTabIndex() must return true for tab index 0',
            renderer.hasTabIndex(goog.dom.$('tabIndex0')));
        assertTrue('hasTabIndex() must return true for tab index 1',
            renderer.hasTabIndex(goog.dom.$('tabIndex1')));
        assertTrue('hasTabIndex() must return true for tab index 2',
            renderer.hasTabIndex(goog.dom.$('tabIndex2')));
      } catch (e) {
        expectedFailures.handleException(e);
      }
    }

    function testEnableTabIndex() {
      var container = goog.dom.$('container');
      assertFalse('Container must not have any tab index',
          renderer.hasTabIndex(container));

      // WebKit on Mac doesn't support tabIndex for arbitrary DOM elements
      // until version 527 or later.
      expectedFailures.expectFailureFor(goog.userAgent.WEBKIT &&
          goog.userAgent.MAC && !goog.userAgent.isVersion('527'));
      try {
        renderer.enableTabIndex(container, true);
        assertTrue('Container must have a tab index',
            renderer.hasTabIndex(container));
        assertEquals('Container\'s tab index must be 0', 0, container.tabIndex);

        renderer.enableTabIndex(container, false);
        assertFalse('Container must not have a tab index',
            renderer.hasTabIndex(container));
        assertEquals('Container\'s tab index must be -1', -1,
            container.tabIndex);
      } catch (e) {
        expectedFailures.handleException(e);
      }
    }

    function testCreateDom() {
      var horizontal = new goog.ui.Container(
          goog.ui.Container.Orientation.HORIZONTAL);
      var element1 = renderer.createDom(horizontal);
      assertEquals('Element must be a DIV', 'DIV', element1.tagName);
      assertEquals('Element must have the expected class name',
          'goog-container goog-container-horizontal',
          element1.className);

      var vertical = new goog.ui.Container(
          goog.ui.Container.Orientation.VERTICAL);
      var element2 = renderer.createDom(vertical);
      assertEquals('Element must be a DIV', 'DIV', element2.tagName);
      assertEquals('Element must have the expected class name',
          'goog-container goog-container-vertical',
          element2.className);
    }

    function testGetContentElement() {
      assertNull('getContentElement() must return null if element is null',
          renderer.getContentElement(null));
      var element = goog.dom.$('container');
      assertEquals('getContentElement() must return its argument',
          element, renderer.getContentElement(element));
    }

    function testCanDecorate() {
      assertFalse('canDecorate() must return false for a SPAN',
          renderer.canDecorate(goog.dom.$('noTabIndex')));
      assertTrue('canDecorate() must return true for a DIV',
          renderer.canDecorate(goog.dom.$('container')));
    }

    function testDecorate() {
      var container = new goog.ui.Container();
      var element = goog.dom.$('container');

      assertFalse('Container must not be in the document',
          container.isInDocument());
      container.decorate(element);
      assertTrue('Container must be in the document',
          container.isInDocument());

      assertEquals('Container\'s ID must match the decorated element\'s ID',
          element.id, container.getId());
      assertEquals('Element must have the expected class name',
          'goog-container-horizontal goog-container', element.className);
      assertEquals('Container must have one child', 1,
          container.getChildCount());
      assertEquals('Child component\'s ID must be as expected', 'control',
          container.getChildAt(0).getId());

      assertThrows('Redecorating must throw error', function() {
        container.decorate(element);
      });
    }

    function testSetStateFromClassName() {
      var container = new goog.ui.Container();

      assertEquals('Container must be vertical',
          goog.ui.Container.Orientation.VERTICAL, container.getOrientation());
      renderer.setStateFromClassName(container, 'goog-container-horizontal',
          'goog-container');
      assertEquals('Container must be horizontal',
          goog.ui.Container.Orientation.HORIZONTAL, container.getOrientation());
      renderer.setStateFromClassName(container, 'goog-container-vertical',
          'goog-container');
      assertEquals('Container must be vertical',
          goog.ui.Container.Orientation.VERTICAL, container.getOrientation());

      assertTrue('Container must be enabled', container.isEnabled());
      renderer.setStateFromClassName(container, 'goog-container-disabled',
          'goog-container');
      assertFalse('Container must be disabled', container.isEnabled());
    }

    function testInitializeDom() {
      var container = new goog.ui.Container();
      var element = goog.dom.$('container');
      container.decorate(element);

      assertTrue('Container\'s root element must be unselectable',
          goog.style.isUnselectable(container.getElement()));

      assertEquals('On IE, container\'s root element must have hideFocus=true',
          goog.userAgent.IE, !!container.getElement().hideFocus);
    }

    function testDoesntCallGetCssClassInConstructor() {
      goog.testing.ui.rendererasserts.
          assertNoGetCssClassCallsInConstructor(goog.ui.ContainerRenderer);
    }
  </SCRIPT><DIV style="position: absolute; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(51, 51, 51); border-right-color: rgb(51, 51, 51); border-bottom-color: rgb(51, 51, 51); border-left-color: rgb(51, 51, 51); right: 10px; top: 10px; width: 400px; display: none; " class=" logdiv"><DIV style="position: absolute; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(51, 51, 51); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(51, 51, 51); right: 0px; top: 0px; width: 1em; height: 1em; cursor: pointer; background-color: rgb(204, 221, 238); text-align: center; color: black; ">X</DIV></DIV>


<DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; font-weight: bold; ">Closure Unit Tests - goog.ui.ContainerRenderer [PASSED]</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; font-weight: bold; ">closure-library.googlecode.com/svn/trunk/closure/goog/ui/containerrenderer_test.html</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">12 of 12 tests run in 49ms.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">12 passed, 0 failed.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">4 ms/test. 58 files loaded.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.214  Start</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.217  testCanDecorate : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.221  testCreateDom : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.242  testDecorate : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.244  testDoesntCallGetCssClassInConstructor : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.246  testEnableTabIndex : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.247  testGetAriaRole : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.249  testGetContentElement : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.250  testGetCustomRenderer : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.252  testGetInstance : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.253  testHasTabIndex : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.258  testInitializeDom : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.261  testSetStateFromClassName : PASSED</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:18:58.262  Done</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; "> </DIV><A style="display: block; font-size: small; " href="">Run again without reloading</A></DIV></BODY></HTML>