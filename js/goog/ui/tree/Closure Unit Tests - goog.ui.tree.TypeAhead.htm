<!DOCTYPE html>
<!-- saved from url=(0088)http://closure-library.googlecode.com/svn/trunk/closure/goog/ui/tree/typeahead_test.html -->
<HTML><!--
  Copyright 2007 Google Inc. All Rights Reserved.

--><HEAD><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<TITLE>Closure Unit Tests - goog.ui.tree.TypeAhead</TITLE>
<SCRIPT src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/base.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/deps.js"></SCRIPT>
<SCRIPT>
  goog.require('goog.testing.jsunit');
  goog.require('goog.dom');
  goog.require('goog.events.KeyCodes');
  goog.require('goog.ui.tree.TreeControl');
  goog.require('goog.ui.tree.TypeAhead');
</SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/stacktrace.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/asserts.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/testcase.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/testrunner.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/jsunit.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/array.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/tagname.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/classes.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/coordinate.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/size.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/object.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/string.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/useragent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/dom.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/keycodes.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/structs.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/iter.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/map.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/set.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/debug.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/logrecord.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/logger.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/a11y.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/errorhandlerweakdep.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/disposable.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/event.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/browserevent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/eventwrapper.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/listener.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/simplepool.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/jscript.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/pools.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/events.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/eventtarget.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/focushandler.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/keyhandler.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/timer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/stringbuffer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/eventhandler.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/box.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/rect.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/product.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/style.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/idgenerator.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/component.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/basenode.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/treenode.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/trie.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/typeahead.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/treecontrol.js"></SCRIPT>
</HEAD><BODY>
  <DIV id="treeContainer" style="width:400px"><DIV class="goog-tree-root goog-tree-item focused" id=":0" hidefocus="true" tabindex="0"><DIV class="goog-tree-row" style="padding-left:0px"><IMG class="goog-tree-icon goog-tree-expanded-folder-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":0.label">level1</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="display: block; background-position: -100px 0px; "><DIV class="goog-tree-item" id=":1"><DIV class="goog-tree-row" style="padding-left:0px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-tminus" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-expanded-folder-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":1.label">level2</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="display: block; background-position: 0px 0px; "><DIV class="goog-tree-item" id=":2"><DIV class="goog-tree-row" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-t" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":2.label">eve</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:19px 0;display:none;"></DIV></DIV><DIV class="goog-tree-item" id=":3"><DIV class="goog-tree-row selected" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-l" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":3.label">eve2</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:-100px 0;display:none;"></DIV></DIV></DIV></DIV><DIV class="goog-tree-item" id=":4"><DIV class="goog-tree-row" style="padding-left:0px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-lminus" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-expanded-folder-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":4.label">level22</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="display: block; background-position: -100px 0px; "><DIV class="goog-tree-item" id=":5"><DIV class="goog-tree-row" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-t" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":5.label">eve</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:19px 0;display:none;"></DIV></DIV><DIV class="goog-tree-item" id=":6"><DIV class="goog-tree-row" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-l" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":6.label">eve3</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:-100px 0;display:none;"></DIV></DIV></DIV></DIV></DIV></DIV><DIV class="goog-tree-root goog-tree-item" id=":7" hidefocus="true" tabindex="0"><DIV class="goog-tree-row" style="padding-left:0px"><IMG class="goog-tree-icon goog-tree-expanded-folder-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":7.label">level1</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="display: block; background-position: -100px 0px; "><DIV class="goog-tree-item" id=":8"><DIV class="goog-tree-row" style="padding-left:0px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-tminus" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-expanded-folder-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":8.label">level2</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="display: block; background-position: 0px 0px; "><DIV class="goog-tree-item" id=":9"><DIV class="goog-tree-row" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-t" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":9.label">eve</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:19px 0;display:none;"></DIV></DIV><DIV class="goog-tree-item" id=":a"><DIV class="goog-tree-row" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-l" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":a.label">eve2</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:-100px 0;display:none;"></DIV></DIV></DIV></DIV><DIV class="goog-tree-item" id=":b"><DIV class="goog-tree-row" style="padding-left:0px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-lminus" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-expanded-folder-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":b.label">level22</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="display: block; background-position: -100px 0px; "><DIV class="goog-tree-item" id=":c"><DIV class="goog-tree-row" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-t" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":c.label">eve</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:19px 0;display:none;"></DIV></DIV><DIV class="goog-tree-item" id=":d"><DIV class="goog-tree-row selected" style="padding-left:19px"><IMG type="expand" class="goog-tree-icon goog-tree-expand-icon goog-tree-expand-icon-l" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><IMG class="goog-tree-icon goog-tree-file-icon" src="./Closure Unit Tests - goog.ui.tree.TypeAhead_files/cleardot.gif"><SPAN class="goog-tree-item-label" id=":d.label">eve3</SPAN><SPAN></SPAN></DIV><DIV class="goog-tree-children" style="background-position:-100px 0;display:none;"></DIV></DIV></DIV></DIV></DIV></DIV></DIV>
<SCRIPT>

function makeATree() {
  var tree = new goog.ui.tree.TreeControl('root');
  var testData = ['level1',
      [['level2', [['eve', []], ['eve2', []]], []],
          ['level22', [['eve', []], ['eve3', []]], []]],
      []];

  createTreeFromTestData(tree, testData, 3);

  var treeElt = tree.createDom();
  goog.dom.$('treeContainer').appendChild(treeElt);
  tree.enterDocument();

  return tree;
};

function createTreeFromTestData(node, data, maxLevels) {
  node.setHtml(data[0]);
  if (maxLevels < 0) {
    return;
}

  var children = data[1];
  for (var i = 0; i < children.length; i++) {
    var child = children[i];
    var childNode = node.getTree().createNode();
    node.add(childNode);
    createTreeFromTestData(childNode, child, maxLevels - 1);
  }
};

/**
 * Test jumpToLabel_ functionality.
 */
function testJumpToLabel() {
  var tree = makeATree();
  var typeAhead = tree.typeAhead_;

  // Test the case when only one matching entry exists.
  var handled = typeAhead.jumpToLabel_('level1');
  var selectedItem = tree.getSelectedItem();
  assertTrue(handled && selectedItem.html_ == 'level1');

  // Test the case when more than one matching entry exists.
  handled = typeAhead.jumpToLabel_('eve');
  selectedItem = tree.getSelectedItem();
  assertTrue(handled && selectedItem.html_ == 'eve');

  // Test the case when the matching entry is at a deeper level.
  handled = typeAhead.jumpToLabel_('eve3');
  selectedItem = tree.getSelectedItem();
  assertTrue(handled && selectedItem.html_ == 'eve3');
};

/**
 * Test jumpTo_ functionality.
 */
function testJumpTo() {
  var tree = makeATree();
  var typeAhead = tree.typeAhead_;

  // Jump to the first matching 'eve', followed by Ctrl+DOWN to jump to
  // second matching 'eve'
  var handled = typeAhead.jumpToLabel_('eve') &&
                typeAhead.jumpTo_(goog.ui.tree.TypeAhead.Offset.DOWN);
  var selectedItem = tree.getSelectedItem();
  assertTrue(handled && selectedItem.html_ == 'eve');

  // Simulate a DOWN key on the tree, now the selection should be on 'eve3'
  var e = new Object();
  e.keyCode = goog.events.KeyCodes.DOWN;
  e.preventDefault = function() {};
  handled = tree.handleKeyEvent(e);
  selectedItem = tree.getSelectedItem();
  assertTrue(handled && selectedItem.html_ == 'eve3');
};
</SCRIPT>

<DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; font-weight: bold; ">Closure Unit Tests - goog.ui.tree.TypeAhead [PASSED]</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; font-weight: bold; ">closure-library.googlecode.com/svn/trunk/closure/goog/ui/tree/typeahead_test.html</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">2 of 2 tests run in 53ms.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">2 passed, 0 failed.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">27 ms/test. 52 files loaded.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:51:39.434  Start</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:51:39.476  testJumpTo : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:51:39.485  testJumpToLabel : PASSED</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:51:39.486  Done</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; "> </DIV><A style="display: block; font-size: small; " href="">Run again without reloading</A></DIV></BODY></HTML>