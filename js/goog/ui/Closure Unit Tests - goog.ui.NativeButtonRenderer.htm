<!DOCTYPE html>
<!-- saved from url=(0094)http://closure-library.googlecode.com/svn/trunk/closure/goog/ui/nativebuttonrenderer_test.html -->
<HTML><!--
Copyright 2008 Google Inc. All Rights Reserved.

--><HEAD><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <TITLE>Closure Unit Tests - goog.ui.NativeButtonRenderer</TITLE>
  <SCRIPT src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/base.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/deps.js"></SCRIPT>
  <SCRIPT>
    goog.require('goog.dom');
    goog.require('goog.events');
    goog.require('goog.testing.ExpectedFailures');
    goog.require('goog.testing.events');
    goog.require('goog.testing.jsunit');
    goog.require('goog.ui.Button');
    goog.require('goog.ui.Component.State');
    goog.require('goog.ui.NativeButtonRenderer');
    goog.require('goog.testing.ui.rendererasserts');
  </SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/array.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/tagname.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/classes.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/coordinate.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/size.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/object.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/string.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/useragent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/dom.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/errorhandlerweakdep.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/disposable.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/event.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/browserevent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/eventwrapper.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/listener.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/simplepool.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/jscript.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/pools.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/events.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/relativetimeprovider.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/formatter.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/structs.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/iter.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/map.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/set.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/debug.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/logrecord.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/logger.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/box.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/rect.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/product.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/style.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/divconsole.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/stacktrace.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/asserts.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/testcase.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/expectedfailures.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/keycodes.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/events(1).js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/testrunner.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/jsunit.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/a11y.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/eventhandler.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/eventtarget.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/idgenerator.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/component.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/controlcontent.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/controlrenderer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/buttonrenderer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/keyhandler.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/registry.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/decorate.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/control.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/nativebuttonrenderer.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/button.js"></SCRIPT><SCRIPT type="text/javascript" src="./Closure Unit Tests - goog.ui.NativeButtonRenderer_files/rendererasserts.js"></SCRIPT>
<STYLE>.dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}</STYLE></HEAD><BODY>
  <DIV id="sandbox"></DIV>
  <SCRIPT>
    var sandbox = goog.dom.$('sandbox');
    var renderer = goog.ui.NativeButtonRenderer.getInstance();
    var expectedFailures = new goog.testing.ExpectedFailures();
    var button;
  
    function setUp() {
      button = new goog.ui.Button('Hello', renderer);
    }
    
    function tearDown() {
      button.dispose();
      goog.dom.removeChildren(sandbox);
      expectedFailures.handleTearDown();
    }

    function testConstructor() {
      assertNotNull('Renderer must not be null', renderer);
    }

    function testGetAriaRole() {
      assertUndefined('ARIA role must be undefined', renderer.getAriaRole());
    }

    function testCreateDom() {
      button.setTooltip('Hello, world!');
      button.setValue('foo');
      var element = renderer.createDom(button);
      assertNotNull('Element must not be null', element);
      assertEquals('Element must be a button', 'BUTTON', element.tagName);
      assertSameElements('Button element must have expected class name',
          ['goog-button'], goog.dom.classes.get(element));
      assertFalse('Button element must be enabled', element.disabled);
      assertEquals('Button element must have expected title', 'Hello, world!',
          element.title);
      // Expected to fail on IE.
      expectedFailures.expectFailureFor(goog.userAgent.IE);
      try {
        // See http://www.fourmilab.ch/fourmilog/archives/2007-03/000824.html
        // for a description of the problem.
        assertEquals('Button element must have expected value', 'foo',
            element.value);
        assertEquals('Button element must have expected contents', 'Hello',
            element.innerHTML);
      } catch (e) {
        expectedFailures.handleException(e);
      }
      assertFalse('Button must not handle its own mouse events',
          button.isHandleMouseEvents());
      assertFalse('Button must not support the custom FOCUSED state',
          button.isSupportedState(goog.ui.Component.State.FOCUSED));
    }

    function testCanDecorate() {
      sandbox.innerHTML =
          '<button id="buttonElement">Button</button>\n' +
          '<input id="inputButton" type="button" value="Input Button">\n' +
          '<input id="inputSubmit" type="submit" value="Input Submit">\n' +
          '<input id="inputReset" type="reset" value="Input Reset">\n' +
          '<input id="inputText" type="text" size="10">\n' +
          '<div id="divButton" class="goog-button">Hello</div>';

      assertTrue('Must be able to decorate <button>',
          renderer.canDecorate(goog.dom.$('buttonElement')));
      assertTrue('Must be able to decorate <input type="button">',
          renderer.canDecorate(goog.dom.$('inputButton')));
      assertTrue('Must be able to decorate <input type="submit">',
          renderer.canDecorate(goog.dom.$('inputSubmit')));
      assertTrue('Must be able to decorate <input type="reset">',
          renderer.canDecorate(goog.dom.$('inputReset')));
      assertFalse('Must not be able to decorate <input type="text">',
          renderer.canDecorate(goog.dom.$('inputText')));
      assertFalse('Must not be able to decorate <div class="goog-button">',
          renderer.canDecorate(goog.dom.$('divButton')));
    }

    function testDecorate() {
      sandbox.innerHTML =
          '<button id="foo" title="Hello!" value="bar">Foo Button</button>\n' +
          '<button id="disabledButton" value="bah" disabled>Disabled</button>';

      var element = renderer.decorate(button, goog.dom.$('foo'));
      assertEquals('Decorated element must be as expected',
          goog.dom.$('foo'), element);
      assertEquals('Decorated button title must have expected value', 'Hello!',
          button.getTooltip());
      // Expected to fail on IE.
      expectedFailures.expectFailureFor(goog.userAgent.IE);
      try {
        // See http://www.fourmilab.ch/fourmilog/archives/2007-03/000824.html
        // for a description of the problem.
        assertEquals('Decorated button value must have expected value', 'bar',
            button.getValue());
      } catch (e) {
        expectedFailures.handleException(e);
      }
            assertFalse('Button must not handle its own mouse events',
          button.isHandleMouseEvents());
      assertFalse('Button must not support the custom FOCUSED state',
          button.isSupportedState(goog.ui.Component.State.FOCUSED));

      element = renderer.decorate(button, goog.dom.$('disabledButton'));
      assertFalse('Decorated button must be disabled', button.isEnabled());
      assertSameElements('Decorated button must have expected class names',
          ['goog-button', 'goog-button-disabled'],
          goog.dom.classes.get(element));
      // Expected to fail on IE.
      expectedFailures.expectFailureFor(goog.userAgent.IE);
      try {
        // See http://www.fourmilab.ch/fourmilog/archives/2007-03/000824.html
        // for a description of the problem.
        assertEquals('Decorated button value must have expected value', 'bah',
            button.getValue());
      } catch (e) {
        expectedFailures.handleException(e);
      }
      assertFalse('Button must not handle its own mouse events',
          button.isHandleMouseEvents());
      assertFalse('Button must not support the custom FOCUSED state',
          button.isSupportedState(goog.ui.Component.State.FOCUSED));
    }

    function testInitializeDom() {
      var dispatchedActionCount = 0;
      var handleAction = function() {
        dispatchedActionCount++;
      };
      goog.events.listen(button, goog.ui.Component.EventType.ACTION,
          handleAction);

      button.render(sandbox);
      goog.testing.events.fireClickSequence(button.getElement());
      assertEquals('Button must have dispatched ACTION on click', 1,
          dispatchedActionCount);

      goog.events.unlisten(button, goog.ui.Component.EventType.ACTION,
          handleAction);
    }

    function testIsFocusable() {
      assertTrue('Enabled button must be focusable',
          renderer.isFocusable(button));
      button.setEnabled(false);
      assertFalse('Disabled button must not be focusable',
          renderer.isFocusable(button));
    }

    function testSetState() {
      button.render(sandbox);
      assertFalse('Button element must not be disabled',
          button.getElement().disabled);
      renderer.setState(button, goog.ui.Component.State.DISABLED, true);
      assertTrue('Button element must be disabled',
          button.getElement().disabled);
    }

    function testGetValue() {
      sandbox.innerHTML = '<button id="foo" value="blah">Hello</button>';
      // Expected to fail on IE.
      expectedFailures.expectFailureFor(goog.userAgent.IE);
      try {
        // See http://www.fourmilab.ch/fourmilog/archives/2007-03/000824.html
        // for a description of the problem.
        assertEquals('Value must be as expected', 'blah',
            renderer.getValue(goog.dom.$('foo')));
      } catch (e) {
        expectedFailures.handleException(e);
      }
    }

    function testSetValue() {
      button.render(sandbox);
      renderer.setValue(button.getElement(), 'What?');
      assertEquals('Button must have expected value', 'What?',
          renderer.getValue(button.getElement()));
    }

    function testDoesntCallGetCssClassInConstructor() {
      goog.testing.ui.rendererasserts.
          assertNoGetCssClassCallsInConstructor(goog.ui.NativeButtonRenderer);
    }
  </SCRIPT><DIV style="position: absolute; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(51, 51, 51); border-right-color: rgb(51, 51, 51); border-bottom-color: rgb(51, 51, 51); border-left-color: rgb(51, 51, 51); right: 10px; top: 10px; width: 400px; display: none; " class=" logdiv"><DIV style="position: absolute; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(51, 51, 51); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(51, 51, 51); right: 0px; top: 0px; width: 1em; height: 1em; cursor: pointer; background-color: rgb(204, 221, 238); text-align: center; color: black; ">X</DIV></DIV>


<DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; font-weight: bold; ">Closure Unit Tests - goog.ui.NativeButtonRenderer [PASSED]</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; font-weight: bold; ">closure-library.googlecode.com/svn/trunk/closure/goog/ui/nativebuttonrenderer_test.html</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">11 of 11 tests run in 29ms.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">11 passed, 0 failed.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">3 ms/test. 58 files loaded.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">.</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.540  Start</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.580  testCanDecorate : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.590  testConstructor : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.630  testCreateDom : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.670  testDecorate : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.680  testDoesntCallGetCssClassInConstructor : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.680  testGetAriaRole : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.690  testGetValue : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.790  testInitializeDom : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.810  testIsFocusable : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.820  testSetState : PASSED</DIV><DIV style="color: rgb(0, 100, 0); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.830  testSetValue : PASSED</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; ">08:34:33.830  Done</DIV><DIV style="color: rgb(51, 51, 51); font: normal normal normal 100%/normal monospace; white-space: pre-wrap; "> </DIV><A style="display: block; font-size: small; " href="">Run again without reloading</A></DIV></BODY></HTML>